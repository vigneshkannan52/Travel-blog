function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ownKeys(e,t){var a,r=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)),r}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(a),!0).forEach(function(t){_defineProperty(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function _defineProperty(t,e,a){return(e=_toPropertyKey(e))in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0===a)return("string"===e?String:Number)(t);a=a.call(t,e||"default");if("object"!==_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}function GetConvertedPrice(t){var e="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.conversion_rate?_wp_travel.conversion_rate:1,a="undefined"!=typeof _wp_travel&&void 0!==_wp_travel.number_of_decimals?_wp_travel.number_of_decimals:2,e=parseFloat(e).toFixed(2);return parseFloat(t*e).toFixed(a)}var wp_travel_cart={format:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"currency",a=wp_travel,r=(a.currency,a.currency_symbol),n=a.currency_position,o=a.decimal_separator,c=a.number_of_decimals,a=a.thousand_separator,l=new RegExp("\\d(?=(\\d{3})+\\".concat(o,")"),"gi"),a="$&".concat(a),c=parseFloat(t).toFixed(c).replace(/\./,o).replace(l,a);return"decimal"==e?c:{left:"".concat(r,"<span>").concat(c,"</span>"),left_with_space:"".concat(r," <span>").concat(c,"</span>"),right:"<span>".concat(c,"</span>").concat(r),right_with_space:"<span>".concat(c,"</span> ").concat(r)}[n]},timeout:function(a,r){return new Promise(function(t,e){setTimeout(function(){e(new Error("request timeout"))},r),t(a.then(t,e))})}},wptravelcheckout=function(w){var a,e,s,t,r,n,o,u=document.getElementById("wp-travel-book-now");u&&u.addEventListener("wptcartchange",function(t){t.target.disabled=!0}),u&&u.addEventListener("click",function(t){}),!w||(t=w&&w.querySelectorAll("[data-cart-id]"))&&t.length<=0||(a=function(t){t?e.removeAttribute("style"):e.style.display="none"},(e=w.querySelector(".wp-travel-cart-loader"))&&a(!0),wp_travel&&wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_get_cart&_nonce=").concat(wp_travel._nonce)).then(function(t){t.json().then(function(t){a(),t.success&&"WP_TRAVEL_CART"===t.data.code&&t.data.cart&&(wp_travel_cart.cart=t.data.cart,Object.freeze(wp_travel_cart.cart))})}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}),s=function(t){var p=0,u=0,o=0,s=0,e=wp_travel_cart.cart&&wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[t],t=w.querySelector('[data-cart-id="'.concat(t,'"]')),d=e.trip_data.pricings.find(function(t){return t.id==parseInt(e.pricing_id)}),_=d.categories,c=d.trip_extras,v=t.querySelectorAll("[data-wpt-category-count]"),y=e.trip_data&&e.trip_data.minimum_partial_payout_percent,a=t.querySelectorAll("[data-wpt-category]"),f=0,a=(a.forEach(function(t){t=t.querySelector("[data-wpt-category-count-input]"),t=t&&parseInt(t.value)||0;f+=t}),a.forEach(function(e){var a,r,t=e.querySelector("[data-wpt-category-total]"),n=e.querySelector("[data-wpt-category-count-input]"),o=e.querySelector("[data-wpt-category-price]"),c=_.find(function(t){return t.id==parseInt(e.dataset.wptCategory)}),l=GetConvertedPrice(l=c&&c.is_sale?parseFloat(c.sale_price):parseFloat(c.regular_price)),i=(o.innerHTML=wp_travel_cart.format(l),n&&parseInt(n.value)||0),n=(void 0!==d.has_group_price&&d.has_group_price&&d.group_prices&&0<d.group_prices.length?(n=d.group_prices.sort((r=1,"-"===(a="max_pax")[0]&&(r=-1,a=a.substr(1)),function(t,e){return(t[a]<e[a]?-1:t[a]>e[a]?1:0)*r})).find(function(t){return parseInt(t.min_pax)<=f&&parseInt(t.max_pax)>=f}))&&n.price&&(l=GetConvertedPrice(l=parseFloat(n.price)),o)&&(o.innerHTML=wp_travel_cart.format(l)):c.has_group_price&&((n=c.group_prices.find(function(t){return i>=parseInt(t.min_pax)&&i<=parseInt(t.max_pax)}))&&n.price&&(l=GetConvertedPrice(l=n.price)),o)&&(o.innerHTML=wp_travel_cart.format(l)),"group"==c.price_per?0<i&&l||0:l*i);v&&v.forEach(function(t){t.dataset.wptCategoryCount==e.dataset.wptCategory&&(t.innerHTML=i)}),t&&(t.innerHTML=wp_travel_cart.format(n)),s+=parseFloat(n),p+=parseFloat(n),u+=parseFloat(n)*parseFloat(y)/100}),t.querySelectorAll("[data-wpt-tx]"));return a&&a.forEach(function(e){var t,a,r,n=c.find(function(t){return t.id==parseInt(e.dataset.wptTx)});n.tour_extras_metas&&(t=e.querySelector("[data-wpt-tx-total]"),r=e.querySelector("[data-wpt-tx-count-input]"),a=e.querySelector("[data-wpt-tx-price]"),n=GetConvertedPrice(n=n.is_sale&&n.tour_extras_metas.extras_item_sale_price||n.tour_extras_metas.extras_item_price),a.innerHTML=wp_travel_cart.format(n),a=r&&r.value||0,r=parseFloat(n)*parseInt(a),t&&(t.innerHTML=wp_travel_cart.format(r)),s+=r,o+=r)}),a={tripTotalWOExtras:p,tripTotalPartialWOExtras:u,extrasTotal:o,tripTotal:s},t.querySelector("[data-wpt-item-total]").innerHTML=wp_travel_cart.format(s),a},w&&w.addEventListener("wptcartchange",function(t){var e,a=0,r=0,n=0,o=document.querySelectorAll("[data-wpt-cart-net-total]"),c=document.querySelectorAll("[data-wpt-cart-partial-total]"),l=t.target.querySelector("[data-wpt-cart-subtotal]"),i=t.target.querySelector("[data-wpt-cart-discount]"),p=t.target.querySelector("[data-wpt-cart-tax]"),u=t.target.querySelectorAll("[data-cart-id]"),l=(u&&u.forEach(function(t){t=s(t.dataset.cartId);a+=t.tripTotal,t.tripTotalWOExtras,n+=t.tripTotalPartialWOExtras,r+=t.extrasTotal}),l&&(l.innerHTML=wp_travel_cart.format(a)),(t.detail&&t.detail.coupon||wp_travel_cart.cart.coupon&&wp_travel_cart.cart.coupon.coupon_id)&&(e=(l=t.detail&&t.detail.coupon||wp_travel_cart.cart.coupon).value&&parseInt(l.value)||0,i&&(i.innerHTML="fixed"==l.type?"- "+wp_travel_cart.format(e):"- "+wp_travel_cart.format(a*e/100),i.closest("[data-wpt-extra-field]").removeAttribute("style")),a="fixed"==l.type?a-e:a*(100-e)/100),wp_travel_cart.cart.total.discount<=0&&(i.closest("[data-wpt-extra-field]").style.display="none"),wp_travel_cart.cart.tax&&(p&&(p.innerHTML="+ "+wp_travel_cart.format(a*parseInt(wp_travel_cart.cart.tax)/100)),a=a*(100+parseInt(wp_travel_cart.cart.tax))/100),o&&o.forEach(function(t){return t.innerHTML=wp_travel_cart.format(a)}),c&&c.forEach(function(t){var e=n+r;wp_travel_cart.cart.tax&&(e=e*(100+parseFloat(wp_travel_cart.cart.tax))/100),t.innerHTML=wp_travel_cart.format(e)}),t.target.querySelector("[data-wpt-cart-item-count]"));l&&(l.innerHTML=u.length)}),t&&t.forEach(function(o){var t=o.querySelector("a.edit"),c=o.querySelector(".update-fields-collapse"),e=o.querySelector(".del-btn"),l=o.querySelector(".wp-travel-cart-loader"),t=(e&&e.addEventListener("click",function(t){t.preventDefault(),confirm(e.dataset.l10n)&&(a(!0),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_remove_cart_item&_nonce=").concat(wp_travel._nonce,"&cart_id=").concat(o.dataset.cartId)).then(function(t){return t.json()}).then(function(t){t.success&&"WP_TRAVEL_REMOVED_CART_ITEM"==t.data.code&&(jQuery(document.body).trigger("wptravel_removed_cart_item",[t.data,o.dataset.cartId,e]),window.location.reload(),wp_travel_cart.cart=t.data.cart,t=t.data.cart.total,wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(t.total),wp_travel.payment.payment_amount=parseFloat(t.total_partial)),o.remove(),w.dispatchEvent(new Event("wptcartchange")),a())}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}))}),t&&t.addEventListener("click",function(t){var e,a,r,n;c.className.indexOf("active")<0?(c.style.display="block",c.classList.add("active")):(c.style.display="none",c.classList.remove("active")),c.className.indexOf("active")<0||(t=t.target.dataset.wptTargetCartId,(t=wp_travel_cart.cart.cart_items&&wp_travel_cart.cart.cart_items[t]||{}).trip_data&&t.trip_data.inventory&&"yes"===t.trip_data.inventory.enable_trip_inventory&&(e="",e=(e=(e+=(n=t.pricing_id||0)&&"pricing_id=".concat(n)||"")+((n=t.trip_data&&t.trip_data.id||0)&&"&trip_id=".concat(n)||""))+((n=t.trip_time)&&"&trip_time=".concat(n)||""),t.arrival_date&&"invalid date"!=new Date(t.arrival_date).toString().toLowerCase()&&(t=(n=new Date(t.arrival_date)).getFullYear(),a=n.getMonth()+1,a=String(a).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),e+=(n="".concat(t,"-").concat(a,"-").concat(r))&&"&selected_date=".concat(n)||""),l.removeAttribute("style"),wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?").concat(e,"&action=wp_travel_get_inventory&_nonce=").concat(wp_travel._nonce)).then(function(t){return t.json().then(function(t){var e;l.style.display="none",t.success&&"WP_TRAVEL_INVENTORY_INFO"===t.data.code&&0<t.data.inventory.length&&(e=t.data.inventory[0],o.querySelectorAll("[data-wpt-category-count-input]").forEach(function(t){return t.max=e.pax_available}))})})).catch(function(t){alert("[X] Request Timeout!"),l.style.display="none"})))}),o.querySelectorAll("[data-wpt-category], [data-wpt-tx]"));t&&t.forEach(function(t){var r=t.querySelector("[data-wpt-category-count-input], [data-wpt-tx-count-input]"),t=t.querySelectorAll("[data-wpt-count-up],[data-wpt-count-down]");t&&t.forEach(function(a){a.addEventListener("click",function(t){t.preventDefault();var e=0;o.querySelectorAll("[data-wpt-category-count-input]").forEach(function(t){e+=parseInt(t.value)}),void 0!==a.dataset.wptCountUp&&(r&&r.dataset.wptCategoryCountInput?(t=parseInt(r.value)+1<0?0:parseInt(r.value)+1,e+1<=parseInt(r.max)&&t>=parseInt(r.min)&&(r.value=t)):r.value=parseInt(r.value)+1),void 0!==a.dataset.wptCountDown&&(r&&r.dataset.wptCategoryCountInput?(t=parseInt(r.value)-1<0?0:parseInt(r.value)-1,e-1<=parseInt(r.max)&&t>=parseInt(r.min)&&(r.value=t)):r.value=parseInt(r.value)-1<parseInt(r.min)?r.min:parseInt(r.value)-1),w.dispatchEvent(new Event("wptcartchange")),u&&u.dispatchEvent(new Event("wptcartchange")),o.querySelector('form [type="submit"]').disabled=!1,o.querySelector("h5 a").style.color="orange"})})})}),t&&t.forEach(function(o){var c=o.querySelector(".wp-travel-cart-loader"),l=o.querySelectorAll("[data-wpt-category]"),i=o.querySelectorAll("[data-wpt-tx]"),p=o.querySelector("form");p.addEventListener("submit",function(t){t.preventDefault();var a=p.querySelector('[type="submit"]'),t=(a.disabled=!0,c.removeAttribute("style"),o.dataset.cartId),r={},n=(l&&l.forEach(function(t){var e=t.querySelector("[data-wpt-category-count-input]"),t=t.dataset.wptCategory,e=e&&e.value;r=_objectSpread(_objectSpread({},r),{},_defineProperty({},t,e))}),{}),e=(i&&i.forEach(function(t){var e=t.querySelector("[data-wpt-tx-count-input]"),t=t.dataset.wptTx,e=e&&e.value;n=_objectSpread(_objectSpread({},n),{},_defineProperty({},t,e))}),{pax:r,wp_travel_trip_extras:{id:Object.keys(n),qty:Object.values(n)}});wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_update_cart_item&cart_id=").concat(t,"&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify(e)}).then(function(t){return t.json()}).then(function(t){var e;c.style.display="none",t.success?(wp_travel_cart.cart=t.data.cart,e=void 0!==(t=t.data.cart&&void 0!==t.data.cart.total?t.data.cart.total:[]).total?t.total:0,t=void 0!==t.total_partial?t.total_partial:0,wp_travel.payment&&(wp_travel.payment.trip_price=parseFloat(e),wp_travel.payment.payment_amount=parseFloat(t)),e=w.querySelectorAll("[data-dirty]"),u&&(e&&0<e.length?u.disabled=!0:u.disabled=!1),o.querySelector("h5 a").removeAttribute("style"),location.reload()):a.disabled=!1}),1e4).catch(function(t){alert("[X] Request Timeout!"),c.style.display="none",a.disabled=!1})})}),(t=document.getElementById("wp-travel-payment-mode"))&&t.addEventListener("change",function(t){var e=document.querySelector("#shopping-cart"),a=e&&e.querySelector("[data-wpt-cart-partial-total]")&&e.querySelector("[data-wpt-cart-partial-total]").closest("p"),r=e&&e.querySelectorAll("[data-wpt-trip-partial-total]")&&e.querySelectorAll("[data-wpt-trip-partial-total]"),n=e&&e.querySelectorAll(".wp-travel-payable-amount")&&e.querySelector(".wp-travel-payable-amount"),e=e&&e.querySelectorAll("[data-wpt-trip-partial-gross-total]")&&e.querySelector("[data-wpt-trip-partial-gross-total]");"partial"===t.target.value?(a&&"none"==a.style.display&&a.removeAttribute("style"),r.forEach(function(t){return t.removeAttribute("style")}),e.removeAttribute("style"),e.classList.add("selected-payable-amount"),n.classList.remove("selected-payable-amount")):(a&&(a.style.display="none"),r.forEach(function(t){return t.style.display="none"}),e.style.display="none",e.classList.remove("selected-payable-amount"),n.classList.add("selected-payable-amount"))}),r=(t=document.getElementById("wp-travel-coupon-form"))&&t.querySelector("button"),(n=t&&t.querySelector(".coupon-input-field"))&&n.addEventListener("keyup",function(t){o(t.target),0<t.target.value.length&&t.target.removeAttribute("style")}),o=function(t,e){var a;e?((a=document.createElement("p")).classList.add("error"),a.innerHTML=e,t.after(a)):(e=t.parentElement.querySelector(".error"))&&e.remove()},r&&n&&r.addEventListener("click",function(e){e.preventDefault(),n.value.length<=0?(n.style.borderColor="red",n.focus()):(a(!0),e.target.disabled=!0,wp_travel_cart.timeout(fetch("".concat(wp_travel.ajaxUrl,"?action=wp_travel_apply_coupon&_nonce=").concat(wp_travel._nonce),{method:"POST",body:JSON.stringify({couponCode:n.value})}).then(function(t){return t.json()}).then(function(t){a(),t.success?(wp_travel_cart.cart=t.data.cart,n.toggleAttribute("readonly"),e.target.innerHTML=e.target.dataset.successL10n,e.target.style.backgroundColor="green",w.dispatchEvent(new CustomEvent("wptcartchange",{detail:{coupon:t.data.cart.coupon}})),location.reload()):(n.focus(),o(n,t.data[0].message),e.target.disabled=!1)}),1e4).catch(function(t){alert("[X] Request Timeout!"),a()}))}))};document.getElementById("shopping-cart")&&wptravelcheckout(document.getElementById("shopping-cart"));